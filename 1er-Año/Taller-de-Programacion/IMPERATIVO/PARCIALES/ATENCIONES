program Hello;
type
    rangoCodigo = 1..15;
    
    atencion = record
        DNI : integer;
        mes: integer;
        codigo:integer;
    end;
    
    atencionArbol = record
        DNI:integer;
        cantAtenciones:integer;
    end;
    
    
    arbol = ^nodoArbol;
    nodoArbol = record
        dato : atencionArbol;
        hi:arbol;
        hd:arbol;
    end;
    
    vector = array [rangoCodigo] of integer;
    
    procedure leerAtencion(var a:atencion);
    begin
        writeln('Ingrese mes');
        readln(a.mes);
        if (a.mes <> 0) then begin
            writeln('Ingrese DNI');
            readln(a.DNI);
            writeln('Ingrese codigo');
            readln(a.codigo);
        end;
    end;
    
    procedure cargarArbol(var ar :arbol;at:atencion);
    begin
        if (ar = nil) then begin
            new(ar);
            ar^.dato.DNI := at.DNI;
            ar^.dato.cantAtenciones := 1;
            ar^.hi := nil;
            ar^.hd := nil;
        end 
        else if (at.DNI = ar^.dato.DNI) then
                ar^.dato.cantAtenciones := ar^.dato.cantAtenciones + 1
            else if (at.DNI < ar^.dato.DNI) then
                    cargarArbol(ar^.hi,at)
                else
                    cargarArbol(ar^.hd,at);
    end;
    
    procedure inicializarVector(var v :vector);
    var
        i:integer;
    begin
        for i := 1 to 15 do begin
            v[i] := 0;
        end;
    end;
    
    procedure cargarVector(var v:vector; a:atencion);
    begin
        v[a.codigo] := v[a.codigo] + 1;
    end;
    
    procedure procesarEstructuras(var v:vector;var a:arbol);
    var
        at:atencion;
    begin
        leerAtencion(at);
        while (at.mes <> 0) do begin
            cargarVector(v,at);
            cargarArbol(a,at);
            leerAtencion(at);
        end;
    end;
    
    function devolverCantEntreValores(a:arbol;dni1:integer;dni2:integer;valorX:integer):integer;
    begin
        if (a = nil) then
            devolverCantEntreValores := 0
        else if (a^.dato.DNI >= dni1) AND (a^.dato.DNI <= dni2) AND (a^.dato.cantAtenciones > valorX) then
                devolverCantEntreValores := 1 + devolverCantEntreValores(a^.hi,dni1,dni2,valorX) + devolverCantEntreValores(a^.hd,dni1,dni2,valorX)
            else if (a^.dato.DNI < dni1) then
                    devolverCantEntreValores := devolverCantEntreValores(a^.hd,dni1,dni2,valorX)
                else if (a^.dato.DNI > dni2) then
                        devolverCantEntreValores := devolverCantEntreValores(a^.hi,dni1,dni2,valorX)
                    else 
                        devolverCantEntreValores := devolverCantEntreValores(a^.hi,dni1,dni2,valorX) + devolverCantEntreValores(a^.hd,dni1,dni2,valorX);
                        
    end;
    
    function devolverCantCero(v:vector;i:integer):integer;
    begin
        if (i > 15) then 
            devolverCantCero := 0
            else if (v[i] = 0) then
                devolverCantCero := 1 + devolverCantCero(v,i + 1)
                else 
                    devolverCantCero := devolverCantCero(v,i+1)
    end;
    
var
    v:vector;
    a:arbol;
begin
  inicializarVector(v);
  a:= nil;
  procesarEstructuras(v,a);
  devolverCantEntreValores(a,dni1,dni2,valorX);
  devolverCantCero(v,1);
end.
