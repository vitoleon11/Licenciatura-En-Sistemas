programa punto5
procesos
  proceso depositarPapeles(E cantPapeles:numero)
  comenzar
    BloquearEsquina(100,1)
    Pos(100,1)
    repetir cantPapeles
      depositarPapel
    Pos(13,1)
    LiberarEsquina(100,1)
  fin
areas
  area1: AreaP(10,1,10,1)
  area2: AreaP(11,1,11,1)
  area3: AreaP(12,1,12,1)
  areaServidor: AreaP(13,1,13,1)
  areaPapeles: AreaC(100,1,100,1)
robots
  robot servidor
  variables
    robotsTerminados,cantPapeles,id:numero
    termino:boolean
  comenzar
    EnviarMensaje(1,C1)
    EnviarMensaje(2,C2)
    EnviarMensaje(3,C3)
    robotsTerminados := 0
    mientras (robotsTerminados < 3)
      Random(cantPapeles,1,5)
      RecibirMensaje(id,*)
      si (id = 1)
        RecibirMensaje(termino,C1)
      sino
        si (id = 2)
          RecibirMensaje(termino,C2)
        sino 
          RecibirMensaje(termino,C3)
          
      si (termino = V)
        robotsTerminados := robotsTerminados + 1
      sino
        si (id = 1)
          depositarPapeles(cantPapeles)
          EnviarMensaje(cantPapeles,C1)
        sino
          si (id = 2)
            depositarPapeles(cantPapeles)
            EnviarMensaje(cantPapeles,C2)
          sino 
            depositarPapeles(cantPapeles)
            EnviarMensaje(cantPapeles,C3)
  fin
  
  robot cliente
  variables
    cantPapeles,avInicial,caInicial,id:numero
  comenzar
    RecibirMensaje(id,rServidor)
    avInicial:= PosAv
    caInicial := PosCa
    repetir 4
      EnviarMensaje(id,rServidor)
      EnviarMensaje(F,rServidor)
      RecibirMensaje(cantPapeles,rServidor)
      BloquearEsquina(100,1)
      Pos(100,1)
      repetir cantPapeles
        tomarPapel
      Pos(avInicial,caInicial)
      LiberarEsquina(100,1)
      mientras HayPapelEnLaBolsa
        depositarPapel
    EnviarMensaje(id,rServidor)
    EnviarMensaje(V,rServidor)
  fin
variables
  C1: cliente
  C2: cliente
  C3: cliente
  rServidor: servidor
comenzar
  AsignarArea(C1,area1)
  AsignarArea(C2,area2)
  AsignarArea(C3,area3)
  AsignarArea(rServidor,areaServidor)
  
  AsignarArea(C1,areaPapeles)
  AsignarArea(C2,areaPapeles)
  AsignarArea(C3,areaPapeles)
  AsignarArea(rServidor,areaPapeles)
  
  Iniciar(C1,10,1)
  Iniciar(C2,11,1)
  Iniciar(C3,12,1)
  Iniciar(rServidor,13,1)
fin
